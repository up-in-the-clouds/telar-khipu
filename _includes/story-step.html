<!--
  Story Step Component
  Used to render individual story steps with data attributes for Scrollama
-->

<div class="story-step"
     data-step="{{ include.step_number }}"
     data-object="{{ include.object_id }}"
     data-x="{{ include.x }}"
     data-y="{{ include.y }}"
     data-zoom="{{ include.zoom }}"
     data-region="{{ include.region }}"
     style="z-index: {{ include.step_number }}">

  <!-- Main content wrapper -->
  <div class="step-content">
    <!-- Question (Main Heading) -->
    <h2 class="step-question">{{ include.question }}</h2>

    <!-- Answer (Main Content) -->
    <div class="step-answer">
      {{ include.answer | markdownify }}
    </div>

    <!-- Viewer Warning (if object or IIIF manifest is missing) -->
    {% if include.viewer_warning and include.viewer_warning != "" %}
    <div class="alert alert-warning mt-3" role="alert">
      <strong>Image viewer unavailable:</strong> {{ include.viewer_warning }}<br>
      Please check <code>components/structures/objects.csv</code> to ensure the object exists and has a valid IIIF manifest URL.
    </div>
    {% endif %}

    <!-- Layer 1 Panel Trigger -->
    {% if (include.layer1_title and include.layer1_title != "") or (include.layer1_text and include.layer1_text != "") %}
    <p class="mt-3">
      <button class="panel-trigger" data-panel="layer1" data-step="{{ include.step_number }}">
        {% if include.layer1button and include.layer1button != "" %}
          {{ include.layer1button }}
        {% else %}
          Learn more
        {% endif %} â†’
      </button>
    </p>
    {% endif %}

    <!-- Layer 2 Panel Trigger: Dynamically added by JavaScript inside layer1 panel -->
  </div>
</div>
